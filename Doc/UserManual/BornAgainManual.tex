%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%%   BornAgain User Manual
%%
%%   homepage:   http://www.bornagainproject.org
%%
%%   copyright:  Forschungszentrum Jülich GmbH 2015
%%
%%   license:    Creative Commons CC-BY-SA
%%   
%%   authors:    Scientific Computing Group at MLZ Garching
%%               C. Durniak, M. Ganeva, G. Pospelov, W. Van Herck, J. Wuttke
%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass[a4paper,11pt,twoside,fleqn]{report}

%-------------------------------------------------------------------------------
%	FONT
%-------------------------------------------------------------------------------
\usepackage{fourier} % must be included before fontspec (upstream bug)
\usepackage{fontspec}
\usepackage{placeins}
%\usepackage[scaled=0.8]{beramono} 

%-------------------------------------------------------------------------------
%	PAGE LAYOUT
%-------------------------------------------------------------------------------
\usepackage[toc,page]{appendix}
\usepackage{titlesec}

\textwidth=410pt
\hoffset=210mm % width of A4
\advance\hoffset by -1\textwidth
\hoffset=0.5\hoffset
\advance\hoffset by -1in
% Now a slight assymmetry to leave more blank on the side of the fold
\evensidemargin=0pt
\oddsidemargin=5pt
\advance\evensidemargin by -1\oddsidemargin

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}

\renewcommand{\sectionmark}[1]{\markright{#1}}

\fancyhead[LO,RE]{Page \thepage}
\fancyhead[LE]{\nouppercase{\leftmark}}
\fancyhead[RO]{\nouppercase{\rightmark}}


\headwidth=1.1\textwidth
\renewcommand{\headrulewidth}{1pt}%{1.5pt}
\renewcommand{\footrulewidth}{0pt}%{1.5pt}
\fancyhfoffset[L]{24pt}
\fancyhfoffset[R]{24pt}

\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\headwidth=1.1\textwidth
\renewcommand{\headrulewidth}{1pt}%{1.5pt}
\renewcommand{\footrulewidth}{0pt}
\fancyhead[LO,RE]{Page \thepage}
\fancyhead[LE]{\nouppercase{\leftmark}}
\fancyhead[RO]{\nouppercase{\rightmark}}

\fancyhfoffset[L]{24pt}
\fancyhfoffset[R]{24pt}
}


\newcommand{\mysection}[2]{%
                         \sectionmark{#1}%
                         \section{#2}%
                         \sectionmark{#1}%
                       }

%-------------------------------------------------------------------------------
%	OTHER PACKAGES 
%-------------------------------------------------------------------------------
\usepackage{makeidx}\makeindex
\usepackage{graphicx}
\usepackage{subfigure}

\usepackage{float}
\usepackage{tikz}
\usepackage{tikz-uml} 
\usetikzlibrary{trees}
\usepackage{amsmath}

\usepackage{pifont}
\usepackage{dingbat}

\usepackage{hyperref}

\usepackage{verbatim}

\usepackage{longtable,tabulary,tabularx}
\usepackage{pdflscape}

\usepackage{multirow}

\usepackage{booktabs}
\renewcommand{\arraystretch}{1.3}

\usetikzlibrary{matrix,positioning,decorations.pathreplacing,calc}

\newcommand{\ntikzmark}[2]{#2\thinspace\tikz[overlay,remember picture,baseline=(#1.base)]{\node[inner sep=0pt] (#1) {};}}

\newcommand{\makebrace}[3]{%
    \begin{tikzpicture}[overlay, remember picture]
        \draw [decoration={brace,amplitude=0.6em},decorate]
        let \p1=(#1), \p2=(#2) in
        ({max(\x1,\x2)}, {\y1+1.5em}) -- node[right=0.6em] {#3} ({max(\x1,\x2)}, {\y2});
    \end{tikzpicture}
}


%-------------------------------------------------------------------------------
%	TABULARY AND LONGTABLE http://tex.stackexchange.com/questions/78075/multi-page-with-tabulary
%-------------------------------------------------------------------------------
\makeatletter

\def\ltabulary{%
\def\endfirsthead{\\}%
\def\endhead{\\}%
\def\endfoot{\\}%
\def\endlastfoot{\\}%
\def\tabulary{%
  \def\TY@final{%
\def\endfirsthead{\LT@end@hd@ft\LT@firsthead}%
\def\endhead{\LT@end@hd@ft\LT@head}%
\def\endfoot{\LT@end@hd@ft\LT@foot}%
\def\endlastfoot{\LT@end@hd@ft\LT@lastfoot}%
\longtable}%
  \let\endTY@final\endlongtable
  \TY@tabular}%
\dimen@\columnwidth
\advance\dimen@-\LTleft
\advance\dimen@-\LTright
\tabulary\dimen@}

\def\endltabulary{\endtabulary}

\makeatother

%-------------------------------------------------------------------------------
%	CUSTON LISTING SETTINGS
%-------------------------------------------------------------------------------

\usepackage{listings}
\usepackage{lstcustom}
\usepackage{enumerate}
\renewcommand{\lstfontfamily}{\ttfamily}

%-------------------------------------------------------------------------------
%	COLORS
%-------------------------------------------------------------------------------

\definecolor{Lightgray}{gray}{.80}
\definecolor{lightgrey}{rgb}{0.9,0.9,0.9}

%-------------------------------------------------------------------------------
%       Commands
%-------------------------------------------------------------------------------

\newcommand{\reffig}[1]{figure \ref{fig:#1}}
\newcommand{\myparagraph}[1]{\paragraph{#1}\mbox{}\\}

\newcommand{\Code}[1]{\texttt{#1}}
\newcommand{\BornAgain}{\Code{BornAgain}}%
\newcommand{\Python}{\Code{Python}}%
\newcommand{\IsGISAXS}{\Code{IsGISAXS}}%
\newcommand{\SecLabel}[1]{\label{sec:#1}}%
\newcommand{\SecRef}[1]{Section~\ref{sec:#1}}% 
\newcommand{\MakeRemark}[2]
{ \noindent \smallpencil \colorbox{Lightgray}{\parbox{\dimexpr\linewidth-8\fboxsep}			{\underline{#1} #2 }}
}
\newcommand{\BareRemark}[1]%
{\noindent\smallpencil\colorbox{Lightgray}%
{\parbox{\dimexpr\linewidth-8\fboxsep}{#1}}}

\newcommand{\ImportantPoint}[2]
{\noindent
  {\huge\danger}\colorbox{Lightgray}{\parbox{\dimexpr\linewidth-8\fboxsep}
 {\underline{#1} #2}}}
\newcommand{\BareWarning}[1]%
{\noindent{\huge\danger}\colorbox{Lightgray}%
{\parbox{\dimexpr\linewidth-8\fboxsep}{#1}}\vspace*{0.7ex}}

\newcommand{\mychapter}[2]{
    \setcounter{chapter}{#1}
    \setcounter{section}{0}
    \chapter*{#2}
    \addcontentsline{toc}{chapter}{#2}
}

\renewcommand\Im{\operatorname{Im}}
\renewcommand\Re{\operatorname{Re}}

\DeclareMathOperator{\sinc}{sinc}

%vector notations
\newcommand{\vect}[1]{\ensuremath{\mathbf{#1}}}
\newcommand{\unitvec}[1]{\ensuremath{\widehat{\vect{#1}}}}
\newcommand{\vectr}{\vect{r}}
\newcommand{\vectk}{\vect{k}}
\newcommand{\vectkt}{\vect{\widetilde{k}}}
\newcommand{\vectq}{\vect{q}}

%curly letters
\newcommand{\curlf}{\ensuremath{\mathcal{F}}}
\newcommand{\curlp}{\ensuremath{\mathcal{P}}}

%basic QM notation (bra, ket, operators, ...)
\newcommand{\oper}[1]{\ensuremath{\mathbf{\hat{#1}}}}
\newcommand{\bra}[1]{\ensuremath{\langle #1 \vert}}
\newcommand{\ket}[1]{\ensuremath{\vert #1 \rangle}}
\newcommand{\braket}[3]{\ensuremath{\left\langle #1 \vert #2 \vert #3 \right\rangle}}
\newcommand{\braketnoop}[2]{\ensuremath{\left\langle #1 \vert #2 \right\rangle}}

%pair correlation functions
\newcommand{\ppcf}[3]{\ensuremath{\mathcal{G}_{#1 ,#2}\left( \vect{#3}_{#1} , \vect{#3}_{#2} \right)}}
\newcommand{\ppcfb}[3]{\ensuremath{\mathcal{G}_{#1 #2}\left( \vect{#3}_{#1 #2} \right)}}

%ensemble average
\newcommand{\ensavg}[2]{\ensuremath{\left\langle #2 \right\rangle_{#1} }}

%reference to equations
\newcommand{\refeq}[1]{equation (\ref{eq:#1})}

%-------------------------------------------------------------------------------
%	HYPHENATION
%-------------------------------------------------------------------------------

\hyphenation{ MacOS }

%-------------------------------------------------------------------------------
%	TITLE PAGE
%-------------------------------------------------------------------------------
\input{UserManualVersion} % defines command UserManualVersionNumber
\title{
{\Huge\bf BornAgain}\\[10mm]
Software for simulating and fitting\\
X-ray and neutron small-angle scattering\\
at grazing incidence\\
\vspace*{10mm} User Manual \\
\vspace*{5mm} \large{Version \UserManualVersionNumber\ (\today)}
\vspace*{5mm}
}

\author{ 
{\Large{Céline Durniak, Marina Ganeva, Gennady Pospelov,} }\\
{\Large{Walter Van Herck, Joachim Wuttke} }\\[10mm]
\large
Scientific Computing Group\\
J\"ulich Centre for Neutron Science\\
at Heinz Maier-Leibnitz Zentrum Garching\\
Forschungszentrum J\"ulich GmbH \\ [40mm]
%\normalsize
%Creative Commons CC-BY-SA
}

\date{{}}
\setlength{\headheight}{15pt}

%------------------------------------------------------------------------------
%	DOCUMENT
%------------------------------------------------------------------------------
\begin{document}

% Title page.
\maketitle

% Back of title page.
\newpage
\thispagestyle{empty}
~\vfill
\noindent
\begin{tabular}{@{}p{7em}@{}l@{}}
Homepage:\index{Homepage}\index{BornAgain@\BornAgain!homepage}
           &http://www.bornagainproject.org\\[2ex]
Copyright:\index{Copyright}\index{BornAgain@\BornAgain!copyright}
            &  Forschungszentrum Jülich GmbH 2013--\the\year\\[2ex]
Licenses:\index{License}\index{BornAgain@\BornAgain!license}
            &Software: GNU General Public License version 3 or higher\\
            &Documentation: Creative Commons CC-BY-SA\\[2ex]
Authors:\index{Authors}\index{BornAgain@\BornAgain!authors}
            &Scientific Computing Group\\
            &at Heinz Maier-Leibnitz Zentrum (MLZ) Garching:\\
            &Céline Durniak, Marina Ganeva, Gennady Pospelov,\\
            &Walter Van Herck, Joachim Wuttke\\[2ex]
Disclaimer:\index{Disclaimer}\index{BornAgain@\BornAgain!disclaimer}
            &Software and documentation are work in progress.\\
            &We cannot guarantee that they are accurate and correct.\\
            &Anyway, it is entirely in the responsibility of users
             to ensure\\
             &that their data interpretation is physically meaningful.\\
\index{Collaboration}
\index{Scientific collaboration}
            &If in doubt, contact us for assistance or scientific collaboration.
\end{tabular}

\tableofcontents

\cleardoublepage

\input{Introduction}
\input{OnlineDocs}
\input{Simulation}
\input{Theory}
\input{Fitting}

\appendix
\addtocontents{toc}{\protect\setcounter{tocdepth}{1}}
\input{theoryapp}
\input{FormFactors}
\input{UserAPI}

% unused old stuff:
%\input{unused/SoftwareArchitecture}
%\input{unused/AppendixListings}
%\input{unused/FittingGentleIntroduction}

\bibliographystyle{switch}
\bibliography{jw7}

\printindex

\end{document}
