%\Work{\indent To be reinserted once
% the chapter on polarized waves propagation is written.}
\iffalse

%\cite{Deak_ppt, PhysRevB.76.224420, Deak2001113, PhysRevB.53.6158}.
%\cite{RevModPhys.23.287}

%-------------------------------------------------------------------------------
\subsection{Wave equation and propagation within one layer}
%-------------------------------------------------------------------------------

To allow for polarization-dependent interactions,
we replace the squared index of refraction $n^2$
by $1+\uu\chi$, where $\uu\chi$ is a $2\times 2$ susceptibility matrix.
The wave equation \cref{Escalar_wave} for layer~$\il$ becomes
\begin{equation}\label{Ewaveqp}  
(\Delta +K^2 +K^2 \uu\chi_\il) \u\psi(\r)= 0,
\end{equation}
where $\u\psi(\r)$ is a two-component spinor wavefunction,
with components $\psi_\UP(\r)$ and~$\psi_\DN(\r)$.
At interfaces between layers,
both spinor components of $\u\psi(\r)$ and $\Nabla\u\psi(\r)$
must evolve continuously.

The reasons for the factorization \cref{Ewave3} still apply,
and so we can write
\begin{equation}\label{Ewave3p}
\u\psi(\r) = \u\psi(z) \e^{i \k_\parallel\r_\parallel}.
\end{equation}
As before, $\k_\parallel$ is constant across layers.
The wave equation~\cref{Ewaveqp} reduces to 
\begin{equation}\label{Ewavezp}
\left(\partial_z^2 + K^2 + K^2\uu\chi_\il - k_\parallel^2 \right) \u\psi(z) = 0.
\end{equation}
We abbreviate
\begin{equation}
  \uu H_\il \coloneqq  K^2(1+\uu\chi_\il)-k_\parallel^2
\end{equation}
so that the wave equation becomes simply
\begin{equation}\label{Ewaveqp2}
  \left(\partial_z^2 + \uu H_\il\right) \u\psi(z) = 0.
\end{equation}
The solution is
\begin{equation}\label{Epsizp}
  \u\psi_\il(z)
  = \sum_{k=1}^2 \u x_{\il k}\left(\alpha_{\il k}\e^{i p_{\il k}(z-z_k)}
                            + \beta_{\il k}\e^{-i p_{\il k}(z-z_k)}\right),
\end{equation}
where the $\u x_{\il k}$ are eigenvectors of $\uu H_\il$
with eigenvalues $p_{\il k}^2$:
\begin{equation}
  \left( -p_{\il k}^2 + \uu H_\il \right) \u x_{\il k} = 0
   \;\text{ for }\;\il=1,2.
\end{equation}
In a reproducible algorithm,
the eigenvectors $\u x_{\il k}$ must be chosen according to some arbitrary
normalization rule,
for instance
\begin{equation}
  |\u x_{\il k}|=1,\quad x_{i\il\UP} \text{ real and nonnegative}.
\end{equation}
Similarly,
a rule is needed how to handle the case of one degenerate eigenvalue,
which includes in particular the case of scalar interactions.


%-------------------------------------------------------------------------------
\subsection{Wave propagation across layers}
%-------------------------------------------------------------------------------

Generalizing \cref{Evecc},
we introduce the coefficient vector
\begin{equation}
  c_\il \coloneqq  {(\alpha_{\il1}, \alpha_{\il2}, \beta_{\il1}, \beta_{\il2})}^\text{T}.
\end{equation}
To match solutions for neighboring layers,
continuity is requested for both spinorial components
of $\u\psi$ and $\Nabla\u\psi$.
As before \cref{EFcFDc}, we have at the bottom of layer~$\il$
\begin{equation}\label{EFcFDcp}
  F_\il c_\il = F_{\il+1} D_{\il+1} c_{\il+1},
\end{equation}
where the matrices are now
\begin{equation}
  F_\il \coloneqq  \left(\begin{array}{cccc}
    x_{i1\UP}      &x_{i2\UP}     &x_{i1\UP}       &x_{i2\UP}       \\
    x_{i1\DN}      &x_{i2\DN}     &x_{i1\DN}       &x_{i2\DN}       \\
    x_{i1\UP}p_{\il1}&x_{i2\UP}p_{\il2}&-x_{i1\UP}p_{\il1}&-x_{i2\UP}p_{\il2}\\
    x_{i1\DN}p_{\il1}&x_{i2\DN}p_{\il2}&-x_{i1\DN}p_{\il1}&-x_{i2\DN}p_{\il2}
  \end{array}\right)
\end{equation}
and
\begin{equation}
  D_\il \coloneqq  \text{diag}(\delta_{\il1}, \delta_{\il2}, \delta_{\il1}^*, \delta_{\il2}^*)
\end{equation}
with the phase factor
\begin{equation}
   \delta_{\il k} \coloneqq  \e^{ip_{\il k}d_k}.
\end{equation}
Note that matrix $F_\il$ has the block form
\begin{equation}
  F_\il
  =\left(\begin{array}{ll}\uu x_\il&\hphantom{-}\uu x_\il\\[1ex]
    \uu x_\il\; \uu P_\il&-\uu x_\il\; \uu P_\il\end{array}\right)
    = \uu x_\il \cdot
    \left(\begin{array}{cc}\uu 1&\uu 1\\[1ex]
    \uu P_\il&-\uu P_\il\end{array}\right),
\end{equation}
with
\begin{equation}
  \uu x_\il \coloneqq 
  \left(\u x_{\il1}, \u x_{\il2}\right),
  \quad
  \uu P_\il \coloneqq 
  \text{diag}\left(p_{\il1},p_{\il2}\right).
\end{equation}
This facilitates the computation of the inverse
\begin{equation}
  F_\il^{-1}
    = \frac{1}{2}
    \left(\begin{array}{cc}\uu 1&\hphantom{-}\uu P_\il^{-1}\\[1.2ex]
      \uu 1 &-\uu P_\il^{-1}\end{array}\right)
      \cdot\uu x_\il^{-1},
\end{equation}
which is needed for the transfer matrix $M_\il$,
defined as in \cref{Edef_M}.
With the new meaning of $c_\il$ and $M_\il$,
the recursion \cref{EcMc} and the explicit solution~\cref{Eci}
hold as derived above.
To resolve~\cref{Eci} for the reflected amplitudes $\alpha_{0\il}$
as function of the incident amplitudes $\beta_{0\il}$,
we choose the notations
\begin{equation}
  \u\alpha_\il
  \coloneqq \left(\begin{array}{c}\alpha_{\il1}\\\alpha_{\il2}\end{array}\right),\quad
  \u\beta_\il
  \coloneqq \left(\begin{array}{c}\beta_{\il1}\\\beta_{\il2}\end{array}\right),\quad
  M\coloneqq M_1 ... M_N % TODO restore \cdots
  \eqqcolon \left(\begin{array}{cc}\uu m_{11}&\uu m_{12}\\
                           \uu m_{21}&\uu m_{22}\end{array}\right),
\end{equation}
where the $\uu m_{\il k}$ are $2\times2$ matrices.
Eq.~\cref{Eci} then takes the form
\begin{equation}
  \left(\begin{array}{c}\u\alpha_{0}\\\u\beta_{0}\end{array}\right)
  = 
  \left(\begin{array}{cc}\uu m_{11}&\uu m_{12}\\
    \uu m_{21}&\uu m_{22}\end{array}\right)
  \left(\begin{array}{c}\u{0}\\\u\beta_{N}\end{array}\right),
\end{equation}
which immediately yields
\begin{equation}
  \u\alpha_0 = \uu m_{12}\,\uu m_{22}^{-1}\,\u\beta_0.
\end{equation}

\fi
